{{/*
  block-meta.html

  Renders optional block metadata (blockCount, timespan, patterns, confidence)
  when present on a page. Gracefully renders nothing when all fields are absent.

  Usage: {{ partial "block-meta.html" (dict "page" .) }}

  Context:
    .page - The page context (containing .Params with blockCount, timespan, patterns, confidence)

  Renders:
    - Block count with block icon/label
    - Timespan with label
    - Linked patterns as pills
    - Confidence bar (calls confidence-bar.html partial)
*/}}

{{ $page := .page }}
{{ $params := $page.Params }}

{{/* Graceful degradation: render nothing if all block fields are absent */}}
{{ if or $params.blockCount $params.timespan $params.patterns $params.confidence }}

  <div class="mt-3 flex flex-wrap items-center gap-3 font-mono text-[12px] text-[var(--text-tertiary)]">

    {{/* Block Count */}}
    {{ with $params.blockCount }}
      <div class="flex items-center gap-1">
        <span class="text-[var(--block-color)]">â¬›</span>
        <span class="text-[var(--text-secondary)]">{{ . }} {{ if eq . 1 }}block{{ else }}blocks{{ end }}</span>
      </div>
    {{ end }}

    {{/* Timespan */}}
    {{ with $params.timespan }}
      <div class="flex items-center gap-1">
        <span class="text-[var(--temporal)]">ðŸ“…</span>
        <span class="text-[var(--text-secondary)]">{{ . }}</span>
      </div>
    {{ end }}

    {{/* Patterns */}}
    {{ with $params.patterns }}
      <div class="flex flex-wrap items-center gap-2">
        {{ range . }}
          <span class="inline-block px-2 py-0.5 rounded-[2px] border border-[var(--border)] text-[var(--text-secondary)]">
            {{ . }}
          </span>
        {{ end }}
      </div>
    {{ end }}

  </div>

  {{/* Confidence Bar */}}
  {{ with $params.confidence }}
    <div class="mt-2">
      {{ partial "confidence-bar.html" (dict "confidence" .) }}
    </div>
  {{ end }}

{{ end }}
