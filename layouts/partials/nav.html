<nav x-data="{ scrolled: false, open: false }"
     @scroll.window="scrolled = window.scrollY > 20"
     @keydown.escape="open = false"
     :class="scrolled ? 'bg-[var(--surface)]/90 backdrop-blur-[10px] border-b border-[var(--border)]' : 'bg-[var(--surface)] border-b border-transparent'"
     class="sticky top-0 w-full z-50 transition-none h-[54px]">
  <div class="mx-auto max-w-[920px] px-4 h-full flex items-center justify-between">
    {{/* Logo */}}
    <a href="/" aria-label="Nicolas de Barquin â€” home" class="flex items-center focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--text-primary)]">
      <img src="/images/debarquin.svg" alt="" aria-hidden="true" width="28" height="28" style="width:28px;height:28px" class="w-7 h-7" />
    </a>

    {{/* Desktop nav links */}}
    <div class="hidden sm:flex items-center gap-6">
      {{ range .Site.Menus.main }}
        {{ if ne .Identifier "home" }}
        <a href="{{ .URL }}"
           class="font-mono text-[14px] focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--text-primary)] {{ if $.IsMenuCurrent "main" . }}text-[var(--text-primary)] font-semibold{{ else }}text-[var(--text-secondary)] font-normal hover:text-[var(--text-primary)]{{ end }}">
          {{ .Name }}
        </a>
        {{ end }}
      {{ end }}
    </div>

    {{/* Mobile hamburger button */}}
    <button class="sm:hidden text-[var(--text-primary)] focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--text-primary)]" @click="open = !open" aria-label="Toggle navigation menu" :aria-expanded="open" aria-controls="mobile-nav-menu">
      <svg fill="currentColor" viewBox="0 0 20 20" class="w-6 h-6">
        <path x-show="!open" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM9 15a1 1 0 011-1h6a1 1 0 110 2h-6a1 1 0 01-1-1z" clip-rule="evenodd"></path>
        <path x-show="open" fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
      </svg>
    </button>
  </div>

  {{/* Mobile menu panel */}}
  <div x-show="open" x-cloak id="mobile-nav-menu"
       class="sm:hidden bg-[var(--surface-elevated)] border-b border-[var(--border)]">
    <div class="mx-auto max-w-[920px] px-4 py-4 flex flex-col gap-4">
      {{ range .Site.Menus.main }}
      <a href="{{ .URL }}" @click="open = false"
         class="font-body text-[14px] focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--text-primary)] {{ if $.IsMenuCurrent "main" . }}text-[var(--text-primary)] font-semibold{{ else }}text-[var(--text-secondary)] font-normal{{ end }}">
        {{ .Name }}
      </a>
      {{ end }}
    </div>
  </div>
</nav>
