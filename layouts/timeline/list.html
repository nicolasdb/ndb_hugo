{{/*
  layouts/timeline/list.html

  Timeline list page for /timeline/.
  Displays timeline moments in chronological order (newest first) with a vertical spine.
  Supports year grouping and semantic color indicators.
*/}}

{{ define "main" }}
<main class="mx-auto max-w-[920px] px-8">
  <header class="pt-12 md:pt-[68px] pb-8 md:pb-[44px]">
    {{ partial "section-heading.html" (dict "label" "MOMENTS OF RECOGNITION" "link" "/timeline/" "linkText" "Full timeline â†’") }}
    {{ with .Content }}
    <div class="font-body text-[17px] leading-[1.7] text-[var(--text-secondary)] max-w-[54ch] mt-3">
      {{ . }}
    </div>
    {{ end }}
  </header>

  {{ if .Pages }}
    <div class="relative pb-12 md:pb-[44px]">
      {{- /* Vertical spine */ -}}
      <div class="absolute left-4 top-0 bottom-0 w-px bg-[var(--timeline-line)]"></div>

      {{- /* Sort pages by date descending (newest first) */ -}}
      {{ $prev_year := "" }}
      {{ range (sort .Pages "Date" "desc") }}
        {{- /* Show year marker when year changes */ -}}
        {{ if ne (.Date.Year | string) $prev_year }}
          <div class="relative pl-12 mb-6 mt-8 first:mt-0">
            {{- /* Year marker ring (11px with 2px stroke, temporal color) */ -}}
            <div class="absolute left-[7px] top-0 flex items-center justify-center">
              <div class="w-[11px] h-[11px] rounded-full border-2 border-[var(--temporal)] bg-white flex items-center justify-center">
                <span class="font-mono text-xs font-bold text-[var(--temporal)] absolute">{{ .Date.Year }}</span>
              </div>
            </div>
          </div>
          {{ $prev_year = (.Date.Year | string) }}
        {{ end }}

        {{- /* Render timeline moment */ -}}
        {{ partial "timeline-moment.html" . }}
      {{ end }}
    </div>
  {{ else }}
    <div class="text-center py-12 md:py-[44px]">
      <p class="font-body text-[15px] text-[var(--text-tertiary)] italic">
        No moments yet. Check back soon.
      </p>
    </div>
  {{ end }}
</main>
{{ end }}
